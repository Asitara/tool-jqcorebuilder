/*! Eqdkp-Plus - v1.1.0pre - 2013-03-22
* http://eqdkp-plus.com
* Copyright (c) 2013 Eqdkp-Plus dev team;
 Licensed CC-BY-NC-SA-3.0 */
(function(t,e){function i(e){t.extend(!0,be,e)}function s(i,s,h){function c(t){J?(C(),k(),q(),y(t)):u()}function u(){Z=s.theme?"ui":"fc",i.addClass("fc"),s.isRTL?i.addClass("fc-rtl"):i.addClass("fc-ltr"),s.theme&&i.addClass("ui-widget"),J=t("<div class='fc-content' style='position:relative'/>").prependTo(i),V=new n(Q,s),K=V.render(),K&&i.prepend(K),b(s.defaultView),t(window).resize(T),v()||p()}function p(){setTimeout(function(){!te.start&&v()&&y()},0)}function f(){t(window).unbind("resize",T),V.destroy(),J.remove(),i.removeClass("fc fc-rtl ui-widget")}function g(){return 0!==oe.offsetWidth}function v(){return 0!==t("body")[0].offsetWidth}function b(e){if(!te||e!=te.name){ce++,A();var i,s=te;s?((s.beforeHide||z)(),L(J,J.height()),s.element.hide()):L(J,1),J.css("overflow","hidden"),te=le[e],te?te.element.show():te=le[e]=new we[e](i=se=t("<div class='fc-view fc-view-"+e+"' style='position:absolute'/>").appendTo(J),Q),s&&V.deactivateButton(s.name),V.activateButton(e),y(),J.css("overflow",""),s&&L(J,1),i||(te.afterShow||z)(),ce--}}function y(t){if(g()){ce++,A(),ie===e&&C();var s=!1;!te.start||t||te.start>ue||ue>=te.end?(te.render(ue,t||0),D(!0),s=!0):te.sizeDirty?(te.clearEvents(),D(),s=!0):te.eventsDirty&&(te.clearEvents(),s=!0),te.sizeDirty=!1,te.eventsDirty=!1,M(s),ee=i.outerWidth(),V.updateTitle(te.title);var n=new Date;n>=te.start&&te.end>n?V.disableButton("today"):V.enableButton("today"),ce--,te.trigger("viewDisplay",oe)}}function x(){k(),g()&&(C(),D(),A(),te.clearEvents(),te.renderEvents(de),te.sizeDirty=!1)}function k(){t.each(le,function(t,e){e.sizeDirty=!0})}function C(){ie=s.contentHeight?s.contentHeight:s.height?s.height-(K?K.height():0)-E(J):Math.round(J.width()/Math.max(s.aspectRatio,.5))}function D(t){ce++,te.setHeight(ie,t),se&&(se.css("position","relative"),se=null),te.setWidth(J.width(),t),ce--}function T(){if(!ce)if(te.start){var t=++he;setTimeout(function(){t==he&&!ce&&g()&&ee!=(ee=i.outerWidth())&&(ce++,x(),te.trigger("windowResize",oe),ce--)},200)}else p()}function M(t){!s.lazyFetching||re(te.visStart,te.visEnd)?S():t&&P()}function S(){ae(te.visStart,te.visEnd)}function j(t){de=t,P()}function I(t){P(t)}function P(t){q(),g()&&(te.clearEvents(),te.renderEvents(de,t),te.eventsDirty=!1)}function q(){t.each(le,function(t,e){e.eventsDirty=!0})}function F(t,i,s){te.select(t,i,s===e?!0:s)}function A(){te&&te.unselect()}function H(){y(-1)}function R(){y(1)}function N(){a(ue,-1),y()}function O(){a(ue,1),y()}function W(){ue=new Date,y()}function $(t,e,i){t instanceof Date?ue=d(t):m(ue,t,e,i),y()}function B(t,i,s){t!==e&&a(ue,t),i!==e&&o(ue,i),s!==e&&l(ue,s),y()}function Y(){return d(ue)}function G(){return te}function X(t,i){return i===e?s[t]:(("height"==t||"contentHeight"==t||"aspectRatio"==t)&&(s[t]=i,x()),e)}function U(t,i){return s[t]?s[t].apply(i||oe,Array.prototype.slice.call(arguments,2)):e}var Q=this;Q.options=s,Q.render=c,Q.destroy=f,Q.refetchEvents=S,Q.reportEvents=j,Q.reportEventChange=I,Q.rerenderEvents=P,Q.changeView=b,Q.select=F,Q.unselect=A,Q.prev=H,Q.next=R,Q.prevYear=N,Q.nextYear=O,Q.today=W,Q.gotoDate=$,Q.incrementDate=B,Q.formatDate=function(t,e){return _(t,e,s)},Q.formatDates=function(t,e,i){return w(t,e,i,s)},Q.getDate=Y,Q.getView=G,Q.option=X,Q.trigger=U,r.call(Q,s,h);var V,K,J,Z,te,ee,ie,se,ne,re=Q.isFetchNeeded,ae=Q.fetchEvents,oe=i[0],le={},he=0,ce=0,ue=new Date,de=[];m(ue,s.year,s.month,s.date),s.droppable&&t(document).bind("dragstart",function(e,i){var n=e.target,r=t(n);if(!r.parents(".fc").length){var a=s.dropAccept;(t.isFunction(a)?a.call(n,r):r.is(a))&&(ne=n,te.dragStart(ne,e,i))}}).bind("dragstop",function(t,e){ne&&(te.dragStop(ne,t,e),ne=null)})}function n(i,s){function n(){p=s.theme?"ui":"fc";var i=s.header;return i?f=t("<table class='fc-header' style='width:100%'/>").append(t("<tr/>").append(a("left")).append(a("center")).append(a("right"))):e}function r(){f.remove()}function a(e){var n=t("<td class='fc-header-"+e+"'/>"),r=s.header[e];return r&&t.each(r.split(" "),function(e){e>0&&n.append("<span class='fc-header-space'/>");var r;t.each(this.split(","),function(e,a){if("title"==a)n.append("<span class='fc-header-title'><h2>&nbsp;</h2></span>"),r&&r.addClass(p+"-corner-right"),r=null;else{var o;if(i[a]?o=i[a]:we[a]&&(o=function(){c.removeClass(p+"-state-hover"),i.changeView(a)}),o){var l=s.theme?Y(s.buttonIcons,a):null,h=Y(s.buttonText,a),c=t("<span class='fc-button fc-button-"+a+" "+p+"-state-default'>"+(l?"<span class='fc-icon-wrap'><span class='ui-icon ui-icon-"+l+"'/>"+"</span>":h)+"</span>").click(function(){c.hasClass(p+"-state-disabled")||o()}).mousedown(function(){c.not("."+p+"-state-active").not("."+p+"-state-disabled").addClass(p+"-state-down")}).mouseup(function(){c.removeClass(p+"-state-down")}).hover(function(){c.not("."+p+"-state-active").not("."+p+"-state-disabled").addClass(p+"-state-hover")},function(){c.removeClass(p+"-state-hover").removeClass(p+"-state-down")}).appendTo(n);U(c),r||c.addClass(p+"-corner-left"),r=c}}}),r&&r.addClass(p+"-corner-right")}),n}function o(t){f.find("h2").html(t)}function l(t){f.find("span.fc-button-"+t).addClass(p+"-state-active")}function h(t){f.find("span.fc-button-"+t).removeClass(p+"-state-active")}function c(t){f.find("span.fc-button-"+t).addClass(p+"-state-disabled")}function u(t){f.find("span.fc-button-"+t).removeClass(p+"-state-disabled")}var d=this;d.render=n,d.destroy=r,d.updateTitle=o,d.activateButton=l,d.deactivateButton=h,d.disableButton=c,d.enableButton=u;var p,f=t([])}function r(i,s){function n(t,e){return!C||C>t||e>D}function r(t,e){C=t,D=e,A=[];var i=++P,s=I.length;q=s;for(var n=0;s>n;n++)a(I[n],i)}function a(e,s){o(e,function(n){if(s==P){if(n){i.eventDataTransform&&(n=t.map(n,i.eventDataTransform)),e.eventDataTransform&&(n=t.map(n,e.eventDataTransform));for(var r=0;n.length>r;r++)n[r].source=e,y(n[r]);A=A.concat(n)}q--,q||S(A)}})}function o(s,n){var r,a,l=_e.sourceFetchers;for(r=0;l.length>r;r++){if(a=l[r](s,C,D,n),a===!0)return;if("object"==typeof a)return o(a,n),e}var h=s.events;if(h)t.isFunction(h)?(m(),h(d(C),d(D),function(t){n(t),b()})):t.isArray(h)?n(h):n();else{var c=s.url;if(c){var u=s.success,p=s.error,f=s.complete,g=t.extend({},s.data||{}),v=Z(s.startParam,i.startParam),y=Z(s.endParam,i.endParam);v&&(g[v]=Math.round(+C/1e3)),y&&(g[y]=Math.round(+D/1e3)),m(),t.ajax(t.extend({},xe,s,{data:g,success:function(e){e=e||[];var i=J(u,this,arguments);t.isArray(i)&&(e=i),n(e)},error:function(){J(p,this,arguments),n()},complete:function(){J(f,this,arguments),b()}}))}else n()}}function l(t){t=h(t),t&&(q++,a(t,P))}function h(i){return t.isFunction(i)||t.isArray(i)?i={events:i}:"string"==typeof i&&(i={url:i}),"object"==typeof i?(_(i),I.push(i),i):e}function c(e){I=t.grep(I,function(t){return!w(t,e)}),A=t.grep(A,function(t){return!w(t.source,e)}),S(A)}function u(t){var e,i,s=A.length,n=M().defaultEventEnd,r=t.start-t._start,a=t.end?t.end-(t._end||n(t)):0;for(e=0;s>e;e++)i=A[e],i._id==t._id&&i!=t&&(i.start=new Date(+i.start+r),i.end=t.end?i.end?new Date(+i.end+a):new Date(+n(i)+a):null,i.title=t.title,i.url=t.url,i.allDay=t.allDay,i.className=t.className,i.editable=t.editable,i.color=t.color,i.backgroudColor=t.backgroudColor,i.borderColor=t.borderColor,i.textColor=t.textColor,y(i));y(t),S(A)}function p(t,e){y(t),t.source||(e&&(j.events.push(t),t.source=j),A.push(t)),S(A)}function f(e){if(e){if(!t.isFunction(e)){var i=e+"";e=function(t){return t._id==i}}A=t.grep(A,e,!0);for(var s=0;I.length>s;s++)t.isArray(I[s].events)&&(I[s].events=t.grep(I[s].events,e,!0))}else{A=[];for(var s=0;I.length>s;s++)t.isArray(I[s].events)&&(I[s].events=[])}S(A)}function g(e){return t.isFunction(e)?t.grep(A,e):e?(e+="",t.grep(A,function(t){return t._id==e})):A}function m(){F++||T("loading",null,!0)}function b(){--F||T("loading",null,!1)}function y(t){var s=t.source||{},n=Z(s.ignoreTimezone,i.ignoreTimezone);t._id=t._id||(t.id===e?"_fc"+ke++:t.id+""),t.date&&(t.start||(t.start=t.date),delete t.date),t._start=d(t.start=v(t.start,n)),t.end=v(t.end,n),t.end&&t.end<=t.start&&(t.end=null),t._end=t.end?d(t.end):null,t.allDay===e&&(t.allDay=Z(s.allDayDefault,i.allDayDefault)),t.className?"string"==typeof t.className&&(t.className=t.className.split(/\s+/)):t.className=[]}function _(t){t.className?"string"==typeof t.className&&(t.className=t.className.split(/\s+/)):t.className=[];for(var e=_e.sourceNormalizers,i=0;e.length>i;i++)e[i](t)}function w(t,e){return t&&e&&x(t)==x(e)}function x(t){return("object"==typeof t?t.events||t.url:"")||t}var k=this;k.isFetchNeeded=n,k.fetchEvents=r,k.addEventSource=l,k.removeEventSource=c,k.updateEvent=u,k.renderEvent=p,k.removeEvents=f,k.clientEvents=g,k.normalizeEvent=y;for(var C,D,T=k.trigger,M=k.getView,S=k.reportEvents,j={events:[]},I=[j],P=0,q=0,F=0,A=[],H=0;s.length>H;H++)h(s[H])}function a(t,e,i){return t.setFullYear(t.getFullYear()+e),i||u(t),t}function o(t,e,i){if(+t){var s=t.getMonth()+e,n=d(t);for(n.setDate(1),n.setMonth(s),t.setMonth(s),i||u(t);t.getMonth()!=n.getMonth();)t.setDate(t.getDate()+(n>t?1:-1))}return t}function l(t,e,i){if(+t){var s=t.getDate()+e,n=d(t);n.setHours(9),n.setDate(s),t.setDate(s),i||u(t),h(t,n)}return t}function h(t,e){if(+t)for(;t.getDate()!=e.getDate();)t.setTime(+t+(e>t?1:-1)*Te)}function c(t,e){return t.setMinutes(t.getMinutes()+e),t}function u(t){return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function d(t,e){return e?u(new Date(+t)):new Date(+t)}function p(){var t,e=0;do t=new Date(1970,e++,1);while(t.getHours());return t}function f(t,e,i){for(e=e||1;!t.getDay()||i&&1==t.getDay()||!i&&6==t.getDay();)l(t,e);return t}function g(t,e){return Math.round((d(t,!0)-d(e,!0))/De)}function m(t,i,s,n){i!==e&&i!=t.getFullYear()&&(t.setDate(1),t.setMonth(0),t.setFullYear(i)),s!==e&&s!=t.getMonth()&&(t.setDate(1),t.setMonth(s)),n!==e&&t.setDate(n)}function v(t,i){return"object"==typeof t?t:"number"==typeof t?new Date(1e3*t):"string"==typeof t?t.match(/^\d+(\.\d+)?$/)?new Date(1e3*parseFloat(t)):(i===e&&(i=!0),b(t,i)||(t?new Date(t):null)):null}function b(t,e){var i=t.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!i)return null;var s=new Date(i[1],0,1);if(e||!i[13]){var n=new Date(i[1],0,1,9,0);i[3]&&(s.setMonth(i[3]-1),n.setMonth(i[3]-1)),i[5]&&(s.setDate(i[5]),n.setDate(i[5])),h(s,n),i[7]&&s.setHours(i[7]),i[8]&&s.setMinutes(i[8]),i[10]&&s.setSeconds(i[10]),i[12]&&s.setMilliseconds(1e3*Number("0."+i[12])),h(s,n)}else if(s.setUTCFullYear(i[1],i[3]?i[3]-1:0,i[5]||1),s.setUTCHours(i[7]||0,i[8]||0,i[10]||0,i[12]?1e3*Number("0."+i[12]):0),i[14]){var r=60*Number(i[16])+(i[18]?Number(i[18]):0);r*="-"==i[15]?1:-1,s=new Date(+s+1e3*60*r)}return s}function y(t){if("number"==typeof t)return 60*t;if("object"==typeof t)return 60*t.getHours()+t.getMinutes();var e=t.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(e){var i=parseInt(e[1],10);return e[3]&&(i%=12,"p"==e[3].toLowerCase().charAt(0)&&(i+=12)),60*i+(e[2]?parseInt(e[2],10):0)}}function _(t,e,i){return w(t,null,e,i)}function w(t,e,i,s){s=s||be;var n,r,a,o,l=t,h=e,c=i.length,u="";for(n=0;c>n;n++)if(r=i.charAt(n),"'"==r){for(a=n+1;c>a;a++)if("'"==i.charAt(a)){l&&(u+=a==n+1?"'":i.substring(n+1,a),n=a);break}}else if("("==r){for(a=n+1;c>a;a++)if(")"==i.charAt(a)){var d=_(l,i.substring(n+1,a),s);parseInt(d.replace(/\D/,""),10)&&(u+=d),n=a;break}}else if("["==r){for(a=n+1;c>a;a++)if("]"==i.charAt(a)){var p=i.substring(n+1,a),d=_(l,p,s);d!=_(h,p,s)&&(u+=d),n=a;break}}else if("{"==r)l=e,h=t;else if("}"==r)l=t,h=e;else{for(a=c;a>n;a--)if(o=Se[i.substring(n,a)]){l&&(u+=o(l,s)),n=a-1;break}a==n&&l&&(u+=r)}return u}function x(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1}function k(t){return t.end?C(t.end,t.allDay):l(d(t.start),1)}function C(t,e){return t=d(t),e||t.getHours()||t.getMinutes()?l(t,1):u(t)}function D(t,e){return 100*(e.msLength-t.msLength)+(t.event.start-e.event.start)}function T(t,e){return t.end>e.start&&t.start<e.end}function M(t,e,i,s){var n,r,a,o,l,h,c,u,p=[],f=t.length;for(n=0;f>n;n++)r=t[n],a=r.start,o=e[n],o>i&&s>a&&(i>a?(l=d(i),c=!1):(l=a,c=!0),o>s?(h=d(s),u=!1):(h=o,u=!0),p.push({event:r,start:l,end:h,isStart:c,isEnd:u,msLength:h-l}));return p.sort(D)}function S(t){var e,i,s,n,r,a=[],o=t.length;for(e=0;o>e;e++){for(i=t[e],s=0;;){if(n=!1,a[s])for(r=0;a[s].length>r;r++)if(T(a[s][r],i)){n=!0;break}if(!n)break;s++}a[s]?a[s].push(i):a[s]=[i]}return a}function j(i,s,n){i.unbind("mouseover").mouseover(function(i){for(var r,a,o,l=i.target;l!=this;)r=l,l=l.parentNode;(a=r._fci)!==e&&(r._fci=e,o=s[a],n(o.event,o.element,o),t(i.target).trigger(i)),i.stopPropagation()})}function I(e,i,s){for(var n,r=0;e.length>r;r++)n=t(e[r]),n.width(Math.max(0,i-q(n,s)))}function P(e,i,s){for(var n,r=0;e.length>r;r++)n=t(e[r]),n.height(Math.max(0,i-E(n,s)))}function q(t,e){return F(t)+H(t)+(e?A(t):0)}function F(e){return(parseFloat(t.css(e[0],"paddingLeft",!0))||0)+(parseFloat(t.css(e[0],"paddingRight",!0))||0)}function A(e){return(parseFloat(t.css(e[0],"marginLeft",!0))||0)+(parseFloat(t.css(e[0],"marginRight",!0))||0)}function H(e){return(parseFloat(t.css(e[0],"borderLeftWidth",!0))||0)+(parseFloat(t.css(e[0],"borderRightWidth",!0))||0)}function E(t,e){return R(t)+O(t)+(e?N(t):0)}function R(e){return(parseFloat(t.css(e[0],"paddingTop",!0))||0)+(parseFloat(t.css(e[0],"paddingBottom",!0))||0)}function N(e){return(parseFloat(t.css(e[0],"marginTop",!0))||0)+(parseFloat(t.css(e[0],"marginBottom",!0))||0)}function O(e){return(parseFloat(t.css(e[0],"borderTopWidth",!0))||0)+(parseFloat(t.css(e[0],"borderBottomWidth",!0))||0)}function L(t,e){e="number"==typeof e?e+"px":e,t.each(function(t,i){i.style.cssText+=";min-height:"+e+";_height:"+e})}function z(){}function W(t,e){return t-e}function $(t){return Math.max.apply(Math,t)}function B(t){return(10>t?"0":"")+t}function Y(t,i){if(t[i]!==e)return t[i];for(var s,n=i.split(/(?=[A-Z])/),r=n.length-1;r>=0;r--)if(s=t[n[r].toLowerCase()],s!==e)return s;return t[""]}function G(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function X(t){return t.id+"/"+t.className+"/"+t.style.cssText.replace(/(^|;)\s*(top|left|width|height)\s*:[^;]*/gi,"")}function U(t){t.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function Q(t){t.children().removeClass("fc-first fc-last").filter(":first-child").addClass("fc-first").end().filter(":last-child").addClass("fc-last")}function V(t,e){t.each(function(t,i){i.className=i.className.replace(/^fc-\w*/,"fc-"+Ce[e.getDay()])})}function K(t,e){var i=t.source||{},s=t.color,n=i.color,r=e("eventColor"),a=t.backgroundColor||s||i.backgroundColor||n||e("eventBackgroundColor")||r,o=t.borderColor||s||i.borderColor||n||e("eventBorderColor")||r,l=t.textColor||i.textColor||e("eventTextColor"),h=[];return a&&h.push("background-color:"+a),o&&h.push("border-color:"+o),l&&h.push("color:"+l),h.join(";")}function J(e,i,s){if(t.isFunction(e)&&(e=[e]),e){var n,r;for(n=0;e.length>n;n++)r=e[n].apply(i,s)||r;return r}}function Z(){for(var t=0;arguments.length>t;t++)if(arguments[t]!==e)return arguments[t]}function te(t,e){function i(t,e){e&&(o(t,e),t.setDate(1));var i=d(t,!0);i.setDate(1);var h=o(d(i),1),c=d(i),u=d(h),p=n("firstDay"),g=n("weekends")?0:1;g&&(f(c),f(u,-1,!0)),l(c,-((c.getDay()-Math.max(p,g)+7)%7)),l(u,(7-u.getDay()+Math.max(p,g))%7);var m=Math.round((u-c)/(7*De));"fixed"==n("weekMode")&&(l(u,7*(6-m)),m=6),s.title=a(i,n("titleFormat")),s.start=i,s.end=h,s.visStart=c,s.visEnd=u,r(m,g?5:7,!0)}var s=this;s.render=i,se.call(s,t,e,"month");var n=s.opt,r=s.renderBasic,a=e.formatDate}function ee(t,e){function i(t,e){e&&l(t,7*e);var i=l(d(t),-((t.getDay()-n("firstDay")+7)%7)),o=l(d(i),7),h=d(i),c=d(o),u=n("weekends");u||(f(h),f(c,-1,!0)),s.title=a(h,l(d(c),-1),n("titleFormat")),s.start=i,s.end=o,s.visStart=h,s.visEnd=c,r(1,u?7:5,!1)}var s=this;s.render=i,se.call(s,t,e,"basicWeek");var n=s.opt,r=s.renderBasic,a=e.formatDates}function ie(t,e){function i(t,e){e&&(l(t,e),n("weekends")||f(t,0>e?-1:1)),s.title=a(t,n("titleFormat")),s.start=s.visStart=d(t,!0),s.end=s.visEnd=l(d(s.start),1),r(1,1,!1)}var s=this;s.render=i,se.call(s,t,e,"basicDay");var n=s.opt,r=s.renderBasic,a=e.formatDate}function se(e,i,s){function n(t,e,i){ie=t,se=e,r();var s=!B;s?a():Me(),o(i)}function r(){le=De("isRTL"),le?(he=-1,ue=se-1):(he=1,ue=0),me=De("firstDay"),be=De("weekends")?0:1,ye=De("theme")?"ui":"fc",_e=De("columnFormat"),we=De("weekNumbers"),xe=De("weekNumberTitle"),ke="iso"!=De("weekNumberCalculation")?"w":"W"}function a(){K=t("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(e)}function o(i){var s,n,r,a,o="",l=ye+"-widget-header",h=ye+"-widget-content",c=O.start.getMonth(),d=u(new Date);for(o+="<table class='fc-border-separate' style='width:100%' cellspacing='0'><thead><tr>",we&&(o+="<th class='fc-week-number "+l+"'/>"),s=0;se>s;s++)o+="<th class='fc-day-header fc-"+Ce[s]+" "+l+"'/>";for(o+="</tr></thead><tbody>",s=0;ie>s;s++){for(o+="<tr class='fc-week'>",we&&(o+="<td class='fc-week-number "+h+"'>"+"<div/>"+"</td>"),n=0;se>n;n++)r=P(s,n),a=["fc-day","fc-"+Ce[r.getDay()],h],r.getMonth()!=c&&a.push("fc-other-month"),+r==+d&&(a.push("fc-today"),a.push(ye+"-state-highlight")),o+="<td class='"+a.join(" ")+"'"+" data-date='"+Pe(r,"yyyy-MM-dd")+"'"+">"+"<div>",i&&(o+="<div class='fc-day-number'>"+r.getDate()+"</div>"),o+="<div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>";o+="</tr>"}o+="</tbody></table>",R(),z&&z.remove(),z=t(o).appendTo(e),W=z.find("thead"),$=W.find(".fc-day-header"),B=z.find("tbody"),Y=B.find("tr"),G=B.find(".fc-day"),X=Y.find("td:first-child"),V=Y.eq(0).find(".fc-day-content > div"),Q(W.add(W.find("tr"))),Q(Y),Y.eq(0).addClass("fc-first"),Y.filter(":last").addClass("fc-last"),we&&W.find(".fc-week-number").text(xe),$.each(function(e,i){var s=q(e);t(i).text(Pe(s,_e))}),we&&B.find(".fc-week-number > div").each(function(e,i){var s=P(e,0);t(i).text(Pe(s,ke))}),G.each(function(e,i){var s=q(e);Te("dayRender",O,s,t(i))}),p(G)}function h(e){Z=e;var i,s,n,r=Z-W.height();"variable"==De("weekMode")?i=s=Math.floor(r/(1==ie?2:6)):(i=Math.floor(r/ie),s=r-i*(ie-1)),X.each(function(e,r){ie>e&&(n=t(r),L(n.find("> div"),(e==ie-1?s:i)-E(n)))}),N()}function c(t){J=t,oe.clear(),ee=0,we&&(ee=W.find("th.fc-week-number").outerWidth()),te=Math.floor((J-ee)/se),I($.slice(0,-1),te)}function p(t){t.click(f).mousedown(Ie)}function f(e){if(!De("selectable")){var i=b(t(this).data("date"));Te("dayClick",this,i,!0,e)}}function m(t,e,i){i&&re.build();for(var s=d(O.visStart),n=l(d(s),se),r=0;ie>r;r++){var a=new Date(Math.max(s,t)),o=new Date(Math.min(n,e));if(o>a){var h,c;le?(h=g(o,s)*he+ue+1,c=g(a,s)*he+ue+1):(h=g(a,s),c=g(o,s)),p(v(r,h,r,c-1))}l(s,7),l(n,7)}}function v(t,i,s,n){var r=re.rect(t,i,s,n,e);return Se(r,e)}function y(t){return d(t)}function _(t,e){m(t,l(d(e),1),!0)}function w(){je()}function x(t,e,i){var s=S(t),n=G[s.row*se+s.col];Te("dayClick",n,t,e,i)}function k(t,e){ae.start(function(t){je(),t&&v(t.row,t.col,t.row,t.col)},e)}function C(t,e,i){var s=ae.stop();if(je(),s){var n=j(s);Te("drop",t,n,!0,e,i)}}function D(t){return d(t.start)}function T(t){return oe.left(t)}function M(t){return oe.right(t)}function S(t){return{row:Math.floor(g(t,O.visStart)/7),col:F(t.getDay())}}function j(t){return P(t.row,t.col)}function P(t,e){return l(d(O.visStart),7*t+e*he+ue)}function q(t){return P(Math.floor(t/se),t%se)}function F(t){return(t-Math.max(me,be)+se)%se*he+ue}function A(t){return Y.eq(t)}function H(){var t=0;return we&&(t+=ee),{left:t,right:J}}function R(){L(e,e.height())}function N(){L(e,1)}var O=this;O.renderBasic=n,O.setHeight=h,O.setWidth=c,O.renderDayOverlay=m,O.defaultSelectionEnd=y,O.renderSelection=_,O.clearSelection=w,O.reportDayClick=x,O.dragStart=k,O.dragStop=C,O.defaultEventEnd=D,O.getHoverListener=function(){return ae},O.colContentLeft=T,O.colContentRight=M,O.dayOfWeekCol=F,O.dateCell=S,O.cellDate=j,O.cellIsAllDay=function(){return!0},O.allDayRow=A,O.allDayBounds=H,O.getRowCnt=function(){return ie},O.getColCnt=function(){return se},O.getColWidth=function(){return te},O.getDaySegmentContainer=function(){return K},ce.call(O,e,i,s),pe.call(O),de.call(O),ne.call(O);var z,W,$,B,Y,G,X,V,K,J,Z,te,ee,ie,se,re,ae,oe,le,he,ue,me,be,ye,_e,we,xe,ke,De=O.opt,Te=O.trigger,Me=O.clearEvents,Se=O.renderOverlay,je=O.clearOverlays,Ie=O.daySelectionMousedown,Pe=i.formatDate;U(e.addClass("fc-grid")),re=new fe(function(e,i){var s,n,r;$.each(function(e,a){s=t(a),n=s.offset().left,e&&(r[1]=n),r=[n],i[e]=r}),r[1]=n+s.outerWidth(),Y.each(function(i,a){ie>i&&(s=t(a),n=s.offset().top,i&&(r[1]=n),r=[n],e[i]=r)}),r[1]=n+s.outerHeight()}),ae=new ge(re),oe=new ve(function(t){return V.eq(t)})}function ne(){function e(t,e){p(t),T(s(t),e),h("eventAfterAllRender")}function i(){f(),y().empty()}function s(e){var i,s,n,r,o,h,c=C(),u=D(),p=d(a.visStart),f=l(d(p),u),g=t.map(e,k),m=[];for(i=0;c>i;i++){for(s=S(M(e,g,p,f)),n=0;s.length>n;n++)for(r=s[n],o=0;r.length>o;o++)h=r[o],h.row=i,h.level=n,m.push(h);l(p,7),l(f,7)}return m}function n(t,e,i){c(t)&&r(t,e),i.isEnd&&u(t)&&j(t,e,i),g(t,e)}function r(t,e){var i,s=_();e.draggable({zIndex:9,delay:50,opacity:o("dragOpacity"),revertDuration:o("dragRevertDuration"),start:function(n,r){h("eventDragStart",e,t,n,r),v(t,e),s.start(function(s,n,r,a){e.draggable("option","revert",!s||!r&&!a),x(),s?(i=7*r+a*(o("isRTL")?-1:1),w(l(d(t.start),i),l(k(t),i))):i=0},n,"drag")},stop:function(n,r){s.stop(),x(),h("eventDragStop",e,t,n,r),i?b(this,t,i,0,t.allDay,n,r):(e.css("filter",""),m(t,e))}})}var a=this;a.renderEvents=e,a.compileDaySegs=s,a.clearEvents=i,a.bindDaySeg=n,ue.call(a);var o=a.opt,h=a.trigger,c=a.isEventDraggable,u=a.isEventResizable,p=a.reportEvents,f=a.reportEventClear,g=a.eventElementHandlers,m=a.showEvents,v=a.hideEvents,b=a.eventDrop,y=a.getDaySegmentContainer,_=a.getHoverListener,w=a.renderDayOverlay,x=a.clearOverlays,C=a.getRowCnt,D=a.getColCnt,T=a.renderDaySegs,j=a.resizableDayEvent}function re(t,e){function i(t,e){e&&l(t,7*e);var i=l(d(t),-((t.getDay()-n("firstDay")+7)%7)),o=l(d(i),7),h=d(i),c=d(o),u=n("weekends");u||(f(h),f(c,-1,!0)),s.title=a(h,l(d(c),-1),n("titleFormat")),s.start=i,s.end=o,s.visStart=h,s.visEnd=c,r(u?7:5)}var s=this;s.render=i,oe.call(s,t,e,"agendaWeek");var n=s.opt,r=s.renderAgenda,a=e.formatDates}function ae(t,e){function i(t,e){e&&(l(t,e),n("weekends")||f(t,0>e?-1:1));var i=d(t,!0),o=l(d(i),1);s.title=a(t,n("titleFormat")),s.start=s.visStart=i,s.end=s.visEnd=o,r(1)}var s=this;s.render=i,oe.call(s,t,e,"agendaDay");var n=s.opt,r=s.renderAgenda,a=e.formatDate}function oe(i,s,n){function r(t){Ee=t,a(),te?ii():o(),h()}function a(){We=ti("theme")?"ui":"fc",Be=ti("weekends")?0:1,$e=ti("firstDay"),(Ye=ti("isRTL"))?(Ge=-1,Xe=Ee-1):(Ge=1,Xe=0),Ue=y(ti("minTime")),Qe=y(ti("maxTime")),Ve=ti("columnFormat"),Ke=ti("weekNumbers"),Je=ti("weekNumberTitle"),Ze="iso"!=ti("weekNumberCalculation")?"w":"W",Fe=ti("snapMinutes")||ti("slotMinutes")}function o(){var e,s,n,r,a,o=We+"-widget-header",l=We+"-widget-content",h=0==ti("slotMinutes")%15;for(e="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'><thead><tr>",e+=Ke?"<th class='fc-agenda-axis fc-week-number "+o+"'/>":"<th class='fc-agenda-axis "+o+"'>&nbsp;</th>",s=0;Ee>s;s++)e+="<th class='fc- fc-col"+s+" "+o+"'/>";for(e+="<th class='fc-agenda-gutter "+o+"'>&nbsp;</th>"+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+"<th class='fc-agenda-axis "+o+"'>&nbsp;</th>",s=0;Ee>s;s++)e+="<td class='fc- fc-col"+s+" "+l+"'>"+"<div>"+"<div class='fc-day-content'>"+"<div style='position:relative'>&nbsp;</div>"+"</div>"+"</div>"+"</td>";for(e+="<td class='fc-agenda-gutter "+l+"'>&nbsp;</td>"+"</tr>"+"</tbody>"+"</table>",te=t(e).appendTo(i),ee=te.find("thead"),ie=ee.find("th").slice(1,-1),se=te.find("tbody"),ne=se.find("td").slice(0,-1),re=ne.find("div.fc-day-content div"),ae=ne.eq(0),oe=ae.find("> div"),Q(ee.add(ee.find("tr"))),Q(se.add(se.find("tr"))),Ce=ee.find("th:first"),De=te.find(".fc-agenda-gutter"),he=t("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(i),ti("allDaySlot")?(ue=t("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(he),e="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'><tr><th class='"+o+" fc-agenda-axis'>"+ti("allDayText")+"</th>"+"<td>"+"<div class='fc-day-content'><div style='position:relative'/></div>"+"</td>"+"<th class='"+o+" fc-agenda-gutter'>&nbsp;</th>"+"</tr>"+"</table>",me=t(e).appendTo(he),be=me.find("tr"),w(be.find("td")),Ce=Ce.add(me.find("th:first")),De=De.add(me.find("th.fc-agenda-gutter")),he.append("<div class='fc-agenda-divider "+o+"'>"+"<div class='fc-agenda-divider-inner'/>"+"</div>")):ue=t([]),ye=t("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(he),_e=t("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(ye),we=t("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(_e),e="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'><tbody>",n=p(),r=c(d(n),Qe),c(n,Ue),Re=0,s=0;r>n;s++)a=n.getMinutes(),e+="<tr class='fc-slot"+s+" "+(a?"fc-minor":"")+"'>"+"<th class='fc-agenda-axis "+o+"'>"+(h&&a?"&nbsp;":hi(n,ti("axisFormat")))+"</th>"+"<td class='"+l+"'>"+"<div style='position:relative'>&nbsp;</div>"+"</td>"+"</tr>",c(n,ti("slotMinutes")),Re++;e+="</tbody></table>",xe=t(e).appendTo(_e),ke=xe.find("div:first"),x(xe.find("td")),Ce=Ce.add(xe.find("th:first"))}function h(){var t,e,i,s,n=u(new Date);if(Ke){var r=hi(F(0),Ze);Ye?r+=Je:r=Je+r,ee.find(".fc-week-number").text(r)}for(t=0;Ee>t;t++)s=F(t),e=ie.eq(t),e.html(hi(s,Ve)),i=ne.eq(t),+s==+n?i.addClass(We+"-state-highlight fc-today"):i.removeClass(We+"-state-highlight fc-today"),V(e.add(i),s)}function f(t,i){t===e&&(t=Se),Se=t,ci={};var s=se.position().top,n=ye.position().top,r=Math.min(t-s,xe.height()+n+1);oe.height(r-E(ae)),he.css("top",s),ye.height(r-n-1),qe=ke.height()+1,Ae=ti("slotMinutes")/Fe,He=qe/Ae,i&&v()}function m(e){Me=e,Le.clear(),je=0,I(Ce.width("").each(function(e,i){je=Math.max(je,t(i).outerWidth())}),je);var i=ye[0].clientWidth;Pe=ye.width()-i,Pe?(I(De,Pe),De.show().prev().removeClass("fc-last")):De.hide().prev().addClass("fc-last"),Ie=Math.floor((i-je)/Ee),I(ie.slice(0,-1),Ie)}function v(){function t(){ye.scrollTop(s)}var e=p(),i=d(e);i.setHours(ti("firstHour"));var s=R(e,i)+1;t(),setTimeout(t,0)}function b(){ze=ye.scrollTop()}function _(){ye.scrollTop(ze)}function w(t){t.click(k).mousedown(oi)}function x(t){t.click(k).mousedown(G)}function k(t){if(!ti("selectable")){var e=Math.min(Ee-1,Math.floor((t.pageX-te.offset().left-je)/Ie)),i=F(e),s=this.parentNode.className.match(/fc-slot(\d+)/);if(s){var n=parseInt(s[1])*ti("slotMinutes"),r=Math.floor(n/60);i.setHours(r),i.setMinutes(n%60+Ue),ei("dayClick",ne[e],i,!1,t)}else ei("dayClick",ne[e],i,!0,t)}}function C(t,e,i){i&&Ne.build();var s,n,r=d(Z.visStart);Ye?(s=g(e,r)*Ge+Xe+1,n=g(t,r)*Ge+Xe+1):(s=g(t,r),n=g(e,r)),s=Math.max(0,s),n=Math.min(Ee,n),n>s&&w(D(0,s,0,n-1))}function D(t,e,i,s){var n=Ne.rect(t,e,i,s,he);return si(n,he)}function T(t,e){for(var i=d(Z.visStart),s=l(d(i),1),n=0;Ee>n;n++){var r=new Date(Math.max(i,t)),a=new Date(Math.min(s,e));if(a>r){var o=n*Ge+Xe,h=Ne.rect(0,o,0,o,_e),c=R(i,r),u=R(i,a);h.top=c,h.height=u-c,x(si(h,_e))}l(i,1),l(s,1)}}function M(t){return Le.left(t)}function S(t){return Le.right(t)}function j(t){return{row:Math.floor(g(t,Z.visStart)/7),col:H(t.getDay())}}function q(t){var e=F(t.col),i=t.row;return ti("allDaySlot")&&i--,i>=0&&c(e,Ue+i*Fe),e}function F(t){return l(d(Z.visStart),t*Ge+Xe)}function A(t){return ti("allDaySlot")&&!t.row}function H(t){return(t-Math.max($e,Be)+Ee)%Ee*Ge+Xe}function R(t,i){if(t=d(t,!0),c(d(t),Ue)>i)return 0;if(i>=c(d(t),Qe))return xe.height();var s=ti("slotMinutes"),n=60*i.getHours()+i.getMinutes()-Ue,r=Math.floor(n/s),a=ci[r];return a===e&&(a=ci[r]=xe.find("tr:eq("+r+") td div")[0].offsetTop),Math.max(0,Math.round(a-1+qe*(n%s/s)))}function N(){return{left:je,right:Me-Pe}}function O(){return be}function L(t){var e=d(t.start);return t.allDay?e:c(e,ti("defaultEventMinutes"))}function z(t,e){return e?d(t):c(d(t),ti("slotMinutes"))}function $(t,e,i){i?ti("allDaySlot")&&C(t,l(d(e),1),!0):B(t,e)}function B(e,i){var s=ti("selectHelper");if(Ne.build(),s){var n=g(e,Z.visStart)*Ge+Xe;if(n>=0&&Ee>n){var r=Ne.rect(0,n,0,n,_e),a=R(e,e),o=R(e,i);if(o>a){if(r.top=a,r.height=o-a,r.left+=2,r.width-=5,t.isFunction(s)){var l=s(e,i);l&&(r.position="absolute",r.zIndex=8,Te=t(l).css(r).appendTo(_e))}else r.isStart=!0,r.isEnd=!0,Te=t(li({title:"",start:e,end:i,className:["fc-select-helper"],editable:!1},r)),Te.css("opacity",ti("dragOpacity"));Te&&(x(Te),_e.append(Te),I(Te,r.width,!0),P(Te,r.height,!0))}}}else T(e,i)}function Y(){ni(),Te&&(Te.remove(),Te=null)}function G(e){if(1==e.which&&ti("selectable")){ai(e);var i;Oe.start(function(t,e){if(Y(),t&&t.col==e.col&&!A(t)){var s=q(e),n=q(t);i=[s,c(d(s),Fe),n,c(d(n),Fe)].sort(W),B(i[0],i[3])}else i=null},e),t(document).one("mouseup",function(t){Oe.stop(),i&&(+i[0]==+i[1]&&X(i[0],!1,t),ri(i[0],i[3],!1,t))})}}function X(t,e,i){ei("dayClick",ne[H(t.getDay())],t,e,i)}function K(t,e){Oe.start(function(t){if(ni(),t)if(A(t))D(t.row,t.col,t.row,t.col);else{var e=q(t),i=c(d(e),ti("defaultEventMinutes"));T(e,i)}},e)}function J(t,e,i){var s=Oe.stop();ni(),s&&ei("drop",t,q(s),A(s),e,i)}var Z=this;Z.renderAgenda=r,Z.setWidth=m,Z.setHeight=f,Z.beforeHide=b,Z.afterShow=_,Z.defaultEventEnd=L,Z.timePosition=R,Z.dayOfWeekCol=H,Z.dateCell=j,Z.cellDate=q,Z.cellIsAllDay=A,Z.allDayRow=O,Z.allDayBounds=N,Z.getHoverListener=function(){return Oe},Z.colContentLeft=M,Z.colContentRight=S,Z.getDaySegmentContainer=function(){return ue},Z.getSlotSegmentContainer=function(){return we},Z.getMinMinute=function(){return Ue},Z.getMaxMinute=function(){return Qe},Z.getBodyContent=function(){return _e},Z.getRowCnt=function(){return 1},Z.getColCnt=function(){return Ee},Z.getColWidth=function(){return Ie},Z.getSnapHeight=function(){return He},Z.getSnapMinutes=function(){return Fe},Z.defaultSelectionEnd=z,Z.renderDayOverlay=C,Z.renderSelection=$,Z.clearSelection=Y,Z.reportDayClick=X,Z.dragStart=K,Z.dragStop=J,ce.call(Z,i,s,n),pe.call(Z),de.call(Z),le.call(Z);var te,ee,ie,se,ne,re,ae,oe,he,ue,me,be,ye,_e,we,xe,ke,Ce,De,Te,Me,Se,je,Ie,Pe,qe,Fe,Ae,He,Ee,Re,Ne,Oe,Le,ze,We,$e,Be,Ye,Ge,Xe,Ue,Qe,Ve,Ke,Je,Ze,ti=Z.opt,ei=Z.trigger,ii=Z.clearEvents,si=Z.renderOverlay,ni=Z.clearOverlays,ri=Z.reportSelection,ai=Z.unselect,oi=Z.daySelectionMousedown,li=Z.slotSegHtml,hi=s.formatDate,ci={};U(i.addClass("fc-agenda")),Ne=new fe(function(e,i){function s(t){return Math.max(l,Math.min(h,t))}var n,r,a;ie.each(function(e,s){n=t(s),r=n.offset().left,e&&(a[1]=r),a=[r],i[e]=a}),a[1]=r+n.outerWidth(),ti("allDaySlot")&&(n=be,r=n.offset().top,e[0]=[r,r+n.outerHeight()]);for(var o=_e.offset().top,l=ye.offset().top,h=l+ye.outerHeight(),c=0;Re*Ae>c;c++)e.push([s(o+He*c),s(o+He*(c+1))])}),Oe=new ge(Ne),Le=new ve(function(t){return re.eq(t)})}function le(){function i(t,e){C(t);var i,s=t.length,a=[],l=[];for(i=0;s>i;i++)t[i].allDay?a.push(t[i]):l.push(t[i]);b("allDaySlot")&&(W(n(a),e),I()),o(r(l),e),y("eventAfterAllRender")}function s(){D(),F().empty(),A().empty()}function n(e){var i,s,n,r,a=S(M(e,t.map(e,k),v.visStart,v.visEnd)),o=a.length,l=[];for(i=0;o>i;i++)for(s=a[i],n=0;s.length>n;n++)r=s[n],r.row=0,r.level=i,l.push(r);return l}function r(e){var i,s,n,r,o,h,u=B(),p=N(),f=R(),g=c(d(v.visStart),p),m=t.map(e,a),b=[];for(i=0;u>i;i++){for(s=S(M(e,m,g,c(d(g),f-p))),he(s),n=0;s.length>n;n++)for(r=s[n],o=0;r.length>o;o++)h=r[o],h.col=i,h.level=n,b.push(h);l(g,1,!0)}return b}function a(t){return t.end?d(t.end):c(d(t.start),b("defaultEventMinutes"))}function o(i,s){var n,r,a,o,l,c,u,d,f,g,m,v,_,w,x,k,C,D,T,M,S,I,P=i.length,F="",H={},R={},N=A(),W=B();for((M=b("isRTL"))?(S=-1,I=W-1):(S=1,I=0),n=0;P>n;n++)r=i[n],a=r.event,o=O(r.start,r.start),l=O(r.start,r.end),c=r.col,u=r.level,d=r.forward||0,f=L(c*S+I),g=z(c*S+I)-f,g=Math.min(g-6,.95*g),m=u?g/(u+d+1):d?2*(g/(d+1)-6):g,v=f+g/(u+d+1)*u*S+(M?g-m:0),r.top=o,r.left=v,r.outerWidth=m,r.outerHeight=l-o,F+=h(a,r);
for(N[0].innerHTML=F,_=N.children(),n=0;P>n;n++)r=i[n],a=r.event,w=t(_[n]),x=y("eventRender",a,a,w),x===!1?w.remove():(x&&x!==!0&&(w.remove(),w=t(x).css({position:"absolute",top:r.top,left:r.left}).appendTo(N)),r.element=w,a._id===s?p(a,w,r):w[0]._fci=n,J(a,w));for(j(N,i,p),n=0;P>n;n++)r=i[n],(w=r.element)&&(C=H[k=r.key=X(w[0])],r.vsides=C===e?H[k]=E(w,!0):C,C=R[k],r.hsides=C===e?R[k]=q(w,!0):C,D=w.find(".fc-event-title"),D.length&&(r.contentTop=D[0].offsetTop));for(n=0;P>n;n++)r=i[n],(w=r.element)&&(w[0].style.width=Math.max(0,r.outerWidth-r.hsides)+"px",T=Math.max(0,r.outerHeight-r.vsides),w[0].style.height=T+"px",a=r.event,r.contentTop!==e&&10>T-r.contentTop&&(w.find("div.fc-event-time").text(ae(a.start,b("timeFormat"))+" - "+a.title),w.find("div.fc-event-title").remove()),y("eventAfterRender",a,a,w))}function h(t,e){var i="<",s=t.url,n=K(t,b),r=["fc-event","fc-event-vert"];return _(t)&&r.push("fc-event-draggable"),e.isStart&&r.push("fc-event-start"),e.isEnd&&r.push("fc-event-end"),r=r.concat(t.className),t.source&&(r=r.concat(t.source.className||[])),i+="<div class='"+r.join(" ")+"'"+" style='position:absolute;z-index:8;top:"+e.top+"px;left:"+e.left+"px;"+n+"'"+">"+(s?"<a href='"+G(s)+"'>":"")+"<div class='fc-event-inner'>"+"<div class='fc-event-time'>"+G(oe(t.start,t.end,b("timeFormat")))+"</div>"+"<div class='fc-event-title'>"+G(t.title)+"</div>"+"</div>"+"<div class='fc-event-bg'></div>",e.isEnd&&w(t)&&(i+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"),i+=(s?"</a>":"")+"</div>"}function u(t,e,i){_(t)&&f(t,e,i.isStart),i.isEnd&&w(t)&&$(t,e,i),T(t,e)}function p(t,e,i){var s=e.find("div.fc-event-time");_(t)&&g(t,e,s),i.isEnd&&w(t)&&m(t,e,s),T(t,e)}function f(t,e,i){function s(){o||(e.width(n).height("").draggable("option","grid",null),o=!0)}var n,r,a,o=!0,h=b("isRTL")?-1:1,c=H(),u=Y(),p=U(),f=Q(),g=N();e.draggable({zIndex:9,opacity:b("dragOpacity","month"),revertDuration:b("dragRevertDuration"),start:function(g,m){y("eventDragStart",e,t,g,m),te(t,e),n=e.width(),c.start(function(n,c,g,m){ne(),n?(r=!1,a=m*h,n.row?i?o&&(e.width(u-10),P(e,p*Math.round((t.end?(t.end-t.start)/Me:b("defaultEventMinutes"))/f)),e.draggable("option","grid",[u,1]),o=!1):r=!0:(se(l(d(t.start),a),l(k(t),a)),s()),r=r||o&&!a):(s(),r=!0),e.draggable("option","revert",r)},g,"drag")},stop:function(i,n){if(c.stop(),ne(),y("eventDragStop",e,t,i,n),r)s(),e.css("filter",""),Z(t,e);else{var l=0;o||(l=Math.round((e.offset().top-V().offset().top)/p)*f+g-(60*t.start.getHours()+t.start.getMinutes())),ee(this,t,a,l,o,i,n)}}})}function g(t,e,i){function s(e){var s,n=c(d(t.start),e);t.end&&(s=c(d(t.end),e)),i.text(oe(n,s,b("timeFormat")))}function n(){u&&(i.css("display",""),e.draggable("option","grid",[m,v]),u=!1)}var r,a,o,h,u=!1,p=b("isRTL")?-1:1,f=H(),g=B(),m=Y(),v=U(),_=Q();e.draggable({zIndex:9,scroll:!1,grid:[m,v],axis:1==g?"y":!1,opacity:b("dragOpacity"),revertDuration:b("dragRevertDuration"),start:function(s,c){y("eventDragStart",e,t,s,c),te(t,e),r=e.position(),o=h=0,f.start(function(s,r,o,h){e.draggable("option","revert",!s),ne(),s&&(a=h*p,b("allDaySlot")&&!s.row?(u||(u=!0,i.hide(),e.draggable("option","grid",null)),se(l(d(t.start),a),l(k(t),a))):n())},s,"drag")},drag:function(t,e){o=Math.round((e.position.top-r.top)/v)*_,o!=h&&(u||s(o),h=o)},stop:function(i,l){var h=f.stop();ne(),y("eventDragStop",e,t,i,l),h&&(a||o||u)?ee(this,t,a,u?0:o,u,i,l):(n(),e.css("filter",""),e.css(r),s(0),Z(t,e))}})}function m(t,e,i){var s,n,r=U(),a=Q();e.resizable({handles:{s:".ui-resizable-handle"},grid:r,start:function(i,r){s=n=0,te(t,e),e.css("z-index",9),y("eventResizeStart",this,t,i,r)},resize:function(o,l){s=Math.round((Math.max(r,e.height())-l.originalSize.height)/r),s!=n&&(i.text(oe(t.start,s||t.end?c(x(t),a*s):null,b("timeFormat"))),n=s)},stop:function(i,n){y("eventResizeStop",this,t,i,n),s?ie(this,t,0,a*s,i,n):(e.css("z-index",8),Z(t,e))}})}var v=this;v.renderEvents=i,v.compileDaySegs=n,v.clearEvents=s,v.slotSegHtml=h,v.bindDaySeg=u,ue.call(v);var b=v.opt,y=v.trigger,_=v.isEventDraggable,w=v.isEventResizable,x=v.eventEnd,C=v.reportEvents,D=v.reportEventClear,T=v.eventElementHandlers,I=v.setHeight,F=v.getDaySegmentContainer,A=v.getSlotSegmentContainer,H=v.getHoverListener,R=v.getMaxMinute,N=v.getMinMinute,O=v.timePosition,L=v.colContentLeft,z=v.colContentRight,W=v.renderDaySegs,$=v.resizableDayEvent,B=v.getColCnt,Y=v.getColWidth,U=v.getSnapHeight,Q=v.getSnapMinutes,V=v.getBodyContent,J=v.reportEventElement,Z=v.showEvents,te=v.hideEvents,ee=v.eventDrop,ie=v.eventResize,se=v.renderDayOverlay,ne=v.clearOverlays,re=v.calendar,ae=re.formatDate,oe=re.formatDates}function he(t){var e,i,s,n,r,a;for(e=t.length-1;e>0;e--)for(n=t[e],i=0;n.length>i;i++)for(r=n[i],s=0;t[e-1].length>s;s++)a=t[e-1][s],T(r,a)&&(a.forward=Math.max(a.forward||0,(r.forward||0)+1))}function ce(t,i,s){function n(t,e){var i=P[t];return"object"==typeof i?Y(i,e||s):i}function r(t,e){return i.trigger.apply(i,[t,e||C].concat(Array.prototype.slice.call(arguments,2),[C]))}function a(t){return h(t)&&!n("disableDragging")}function o(t){return h(t)&&!n("disableResizing")}function h(t){return Z(t.editable,(t.source||{}).editable,n("editable"))}function u(t){S={};var e,i,s=t.length;for(e=0;s>e;e++)i=t[e],S[i._id]?S[i._id].push(i):S[i._id]=[i]}function p(t){return t.end?d(t.end):D(t)}function f(t,e){j.push(e),I[t._id]?I[t._id].push(e):I[t._id]=[e]}function g(){j=[],I={}}function m(t,i){i.click(function(s){return i.hasClass("ui-draggable-dragging")||i.hasClass("ui-resizable-resizing")?e:r("eventClick",this,t,s)}).hover(function(e){r("eventMouseover",this,t,e)},function(e){r("eventMouseout",this,t,e)})}function v(t,e){y(t,e,"show")}function b(t,e){y(t,e,"hide")}function y(t,e,i){var s,n=I[t._id],r=n.length;for(s=0;r>s;s++)e&&n[s][0]==e[0]||n[s][i]()}function _(t,e,i,s,n,a,o){var l=e.allDay,h=e._id;x(S[h],i,s,n),r("eventDrop",t,e,i,s,n,function(){x(S[h],-i,-s,l),M(h)},a,o),M(h)}function w(t,e,i,s,n,a){var o=e._id;k(S[o],i,s),r("eventResize",t,e,i,s,function(){k(S[o],-i,-s),M(o)},n,a),M(o)}function x(t,i,s,n){s=s||0;for(var r,a=t.length,o=0;a>o;o++)r=t[o],n!==e&&(r.allDay=n),c(l(r.start,i,!0),s),r.end&&(r.end=c(l(r.end,i,!0),s)),T(r,P)}function k(t,e,i){i=i||0;for(var s,n=t.length,r=0;n>r;r++)s=t[r],s.end=c(l(p(s),e,!0),i),T(s,P)}var C=this;C.element=t,C.calendar=i,C.name=s,C.opt=n,C.trigger=r,C.isEventDraggable=a,C.isEventResizable=o,C.reportEvents=u,C.eventEnd=p,C.reportEventElement=f,C.reportEventClear=g,C.eventElementHandlers=m,C.showEvents=v,C.hideEvents=b,C.eventDrop=_,C.eventResize=w;var D=C.defaultEventEnd,T=i.normalizeEvent,M=i.reportEventChange,S={},j=[],I={},P=i.options}function ue(){function i(t,e){var i,s,l,d,m,v,b,y,_=O(),w=M(),x=S(),k=0,C=t.length;for(_[0].innerHTML=n(t),r(t,_.children()),a(t),o(t,_,e),h(t),c(t),u(t),i=p(),s=0;w>s;s++){for(l=0,d=[],m=0;x>m;m++)d[m]=0;for(;C>k&&(v=t[k]).row==s;){for(b=$(d.slice(v.startCol,v.endCol)),v.top=b,b+=v.outerHeight,y=v.startCol;v.endCol>y;y++)d[y]=b;k++}i[s].height($(d))}g(t,f(i))}function s(e,i,s){var a,o,l,d=t("<div/>"),m=O(),v=e.length;for(d[0].innerHTML=n(e),a=d.children(),m.append(a),r(e,a),h(e),c(e),u(e),g(e,f(p())),a=[],o=0;v>o;o++)l=e[o].element,l&&(e[o].row===i&&l.css("top",s),a.push(l[0]));return t(a)}function n(t){var e,i,s,n,r,a,o,l,h,c,u=b("isRTL"),d=t.length,p=P(),f=p.left,g=p.right,m="";for(e=0;d>e;e++)i=t[e],s=i.event,r=["fc-event","fc-event-hori"],_(s)&&r.push("fc-event-draggable"),i.isStart&&r.push("fc-event-start"),i.isEnd&&r.push("fc-event-end"),u?(a=H(i.end.getDay()-1),o=H(i.start.getDay()),l=i.isEnd?F(a):f,h=i.isStart?A(o):g):(a=H(i.start.getDay()),o=H(i.end.getDay()-1),l=i.isStart?F(a):f,h=i.isEnd?A(o):g),r=r.concat(s.className),s.source&&(r=r.concat(s.source.className||[])),n=s.url,c=K(s,b),m+="<div class='"+r.join(" ")+"'"+" style='position:absolute;z-index:8;left:"+l+"px;"+c+"'"+">"+(n?"<a href='"+G(n)+"'>":"")+"<div class='fc-event-inner'>",!s.allDay&&i.isStart&&(m+="<span class='fc-event-time'>"+G(z(s.start,s.end,b("timeFormat")))+"</span>"),m+="<span class='fc-event-title'>"+G(s.title)+"</span>"+"</div>",i.isEnd&&w(s)&&(m+="<div class='ui-resizable-handle ui-resizable-"+(u?"w":"e")+"'>"+"&nbsp;&nbsp;&nbsp;"+"</div>"),m+=(n?"</a>":"")+"</div>",i.left=l,i.outerWidth=h-l,i.startCol=a,i.endCol=o+1;return m}function r(e,i){var s,n,r,a,o,l=e.length;for(s=0;l>s;s++)n=e[s],r=n.event,a=t(i[s]),o=y("eventRender",r,r,a),o===!1?a.remove():(o&&o!==!0&&(o=t(o).css({position:"absolute",left:n.left}),a.replaceWith(o),a=o),n.element=a)}function a(t){var e,i,s,n=t.length;for(e=0;n>e;e++)i=t[e],s=i.element,s&&k(i.event,s)}function o(t,e,i){var s,n,r,a,o=t.length;for(s=0;o>s;s++)n=t[s],r=n.element,r&&(a=n.event,a._id===i?L(a,r,n):r[0]._fci=s);j(e,t,L)}function h(t){var i,s,n,r,a,o=t.length,l={};for(i=0;o>i;i++)s=t[i],n=s.element,n&&(r=s.key=X(n[0]),a=l[r],a===e&&(a=l[r]=q(n,!0)),s.hsides=a)}function c(t){var e,i,s,n=t.length;for(e=0;n>e;e++)i=t[e],s=i.element,s&&(s[0].style.width=Math.max(0,i.outerWidth-i.hsides)+"px")}function u(t){var i,s,n,r,a,o=t.length,l={};for(i=0;o>i;i++)s=t[i],n=s.element,n&&(r=s.key,a=l[r],a===e&&(a=l[r]=N(n)),s.outerHeight=n[0].offsetHeight+a)}function p(){var t,e=M(),i=[];for(t=0;e>t;t++)i[t]=I(t).find("div.fc-day-content > div");return i}function f(t){var e,i=t.length,s=[];for(e=0;i>e;e++)s[e]=t[e][0].offsetTop;return s}function g(t,e){var i,s,n,r,a=t.length;for(i=0;a>i;i++)s=t[i],n=s.element,n&&(n[0].style.top=e[s.row]+(s.top||0)+"px",r=s.event,y("eventAfterRender",r,r,n))}function m(e,i,n){var r=b("isRTL"),a=r?"w":"e",o=i.find(".ui-resizable-"+a),h=!1;U(i),i.mousedown(function(t){t.preventDefault()}).click(function(t){h&&(t.preventDefault(),t.stopImmediatePropagation())}),o.mousedown(function(o){function c(i){y("eventResizeStop",this,e,i),t("body").css("cursor",""),f.stop(),B(),u&&T(this,e,u,0,i),setTimeout(function(){h=!1},0)}if(1==o.which){h=!0;var u,p,f=v.getHoverListener(),g=M(),m=S(),b=r?-1:1,_=r?m-1:0,w=i.css("top"),k=t.extend({},e),j=E(e.start);Y(),t("body").css("cursor",a+"-resize").one("mouseup",c),y("eventResizeStart",this,e,o),f.start(function(t,i){if(t){var o=Math.max(j.row,t.row),h=t.col;1==g&&(o=0),o==j.row&&(h=r?Math.min(j.col,h):Math.max(j.col,h)),u=7*o+h*b+_-(7*i.row+i.col*b+_);var c=l(x(e),u,!0);if(u){k.end=c;var f=p;p=s(R([k]),n.row,w),p.find("*").css("cursor",a+"-resize"),f&&f.remove(),D(e)}else p&&(C(e),p.remove(),p=null);B(),W(e.start,l(d(c),1))}},o)}})}var v=this;v.renderDaySegs=i,v.resizableDayEvent=m;var b=v.opt,y=v.trigger,_=v.isEventDraggable,w=v.isEventResizable,x=v.eventEnd,k=v.reportEventElement,C=v.showEvents,D=v.hideEvents,T=v.eventResize,M=v.getRowCnt,S=v.getColCnt;v.getColWidth;var I=v.allDayRow,P=v.allDayBounds,F=v.colContentLeft,A=v.colContentRight,H=v.dayOfWeekCol,E=v.dateCell,R=v.compileDaySegs,O=v.getDaySegmentContainer,L=v.bindDaySeg,z=v.calendar.formatDates,W=v.renderDayOverlay,B=v.clearOverlays,Y=v.clearSelection}function de(){function e(t,e,n){i(),e||(e=l(t,n)),h(t,e,n),s(t,e,n)}function i(t){u&&(u=!1,c(),o("unselect",null,t))}function s(t,e,i,s){u=!0,o("select",null,t,e,i,s)}function n(e){var n=r.cellDate,o=r.cellIsAllDay,l=r.getHoverListener(),u=r.reportDayClick;if(1==e.which&&a("selectable")){i(e);var d;l.start(function(t,e){c(),t&&o(t)?(d=[n(e),n(t)].sort(W),h(d[0],d[1],!0)):d=null},e),t(document).one("mouseup",function(t){l.stop(),d&&(+d[0]==+d[1]&&u(d[0],!0,t),s(d[0],d[1],!0,t))})}}var r=this;r.select=e,r.unselect=i,r.reportSelection=s,r.daySelectionMousedown=n;var a=r.opt,o=r.trigger,l=r.defaultSelectionEnd,h=r.renderSelection,c=r.clearSelection,u=!1;a("selectable")&&a("unselectAuto")&&t(document).mousedown(function(e){var s=a("unselectCancel");s&&t(e.target).parents(s).length||i(e)})}function pe(){function e(e,i){var s=r.shift();return s||(s=t("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>")),s[0].parentNode!=i[0]&&s.appendTo(i),n.push(s.css(e).show()),s}function i(){for(var t;t=n.shift();)r.push(t.hide().unbind())}var s=this;s.renderOverlay=e,s.clearOverlays=i;var n=[],r=[]}function fe(t){var e,i,s=this;s.build=function(){e=[],i=[],t(e,i)},s.cell=function(t,s){var n,r=e.length,a=i.length,o=-1,l=-1;for(n=0;r>n;n++)if(s>=e[n][0]&&e[n][1]>s){o=n;break}for(n=0;a>n;n++)if(t>=i[n][0]&&i[n][1]>t){l=n;break}return o>=0&&l>=0?{row:o,col:l}:null},s.rect=function(t,s,n,r,a){var o=a.offset();return{top:e[t][0]-o.top,left:i[s][0]-o.left,width:i[r][1]-i[s][0],height:e[n][1]-e[t][0]}}}function ge(e){function i(t){me(t);var i=e.cell(t.pageX,t.pageY);(!i!=!a||i&&(i.row!=a.row||i.col!=a.col))&&(i?(r||(r=i),n(i,r,i.row-r.row,i.col-r.col)):n(i,r),a=i)}var s,n,r,a,o=this;o.start=function(o,l,h){n=o,r=a=null,e.build(),i(l),s=h||"mousemove",t(document).bind(s,i)},o.stop=function(){return t(document).unbind(s,i),a}}function me(t){t.pageX===e&&(t.pageX=t.originalEvent.pageX,t.pageY=t.originalEvent.pageY)}function ve(t){function i(e){return n[e]=n[e]||t(e)}var s=this,n={},r={},a={};s.left=function(t){return r[t]=r[t]===e?i(t).position().left:r[t]},s.right=function(t){return a[t]=a[t]===e?s.left(t)+i(t).width():a[t]},s.clear=function(){n={},r={},a={}}}var be={defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"iso",weekNumberTitle:"W",allDayDefault:!0,ignoreTimezone:!0,lazyFetching:!0,startParam:"start",endParam:"end",titleFormat:{month:"MMMM yyyy",week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:"dddd, MMM d, yyyy"},columnFormat:{month:"ddd",week:"ddd M/d",day:"dddd M/d"},timeFormat:{"":"h(:mm)t"},isRTL:!1,firstDay:0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{prev:"<span class='fc-text-arrow'>&lsaquo;</span>",next:"<span class='fc-text-arrow'>&rsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&laquo;</span>",nextYear:"<span class='fc-text-arrow'>&raquo;</span>",today:"today",month:"month",week:"week",day:"day"},theme:!1,buttonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e"},unselectAuto:!0,dropAccept:"*"},ye={header:{left:"next,prev today",center:"",right:"title"},buttonText:{prev:"<span class='fc-text-arrow'>&rsaquo;</span>",next:"<span class='fc-text-arrow'>&lsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&raquo;</span>",nextYear:"<span class='fc-text-arrow'>&laquo;</span>"},buttonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w"}},_e=t.fullCalendar={version:"1.6.0"},we=_e.views={};t.fn.fullCalendar=function(i){if("string"==typeof i){var n,r=Array.prototype.slice.call(arguments,1);return this.each(function(){var s=t.data(this,"fullCalendar");if(s&&t.isFunction(s[i])){var a=s[i].apply(s,r);n===e&&(n=a),"destroy"==i&&t.removeData(this,"fullCalendar")}}),n!==e?n:this}var a=i.eventSources||[];return delete i.eventSources,i.events&&(a.push(i.events),delete i.events),i=t.extend(!0,{},be,i.isRTL||i.isRTL===e&&be.isRTL?ye:{},i),this.each(function(e,n){var r=t(n),o=new s(r,i,a);r.data("fullCalendar",o),o.render()}),this},_e.sourceNormalizers=[],_e.sourceFetchers=[];var xe={dataType:"json",cache:!1},ke=1;_e.addDays=l,_e.cloneDate=d,_e.parseDate=v,_e.parseISO8601=b,_e.parseTime=y,_e.formatDate=_,_e.formatDates=w;var Ce=["sun","mon","tue","wed","thu","fri","sat"],De=864e5,Te=36e5,Me=6e4,Se={s:function(t){return t.getSeconds()},ss:function(t){return B(t.getSeconds())},m:function(t){return t.getMinutes()},mm:function(t){return B(t.getMinutes())},h:function(t){return t.getHours()%12||12},hh:function(t){return B(t.getHours()%12||12)},H:function(t){return t.getHours()},HH:function(t){return B(t.getHours())},d:function(t){return t.getDate()},dd:function(t){return B(t.getDate())},ddd:function(t,e){return e.dayNamesShort[t.getDay()]},dddd:function(t,e){return e.dayNames[t.getDay()]},M:function(t){return t.getMonth()+1},MM:function(t){return B(t.getMonth()+1)},MMM:function(t,e){return e.monthNamesShort[t.getMonth()]},MMMM:function(t,e){return e.monthNames[t.getMonth()]},yy:function(t){return(t.getFullYear()+"").substring(2)},yyyy:function(t){return t.getFullYear()},t:function(t){return 12>t.getHours()?"a":"p"},tt:function(t){return 12>t.getHours()?"am":"pm"},T:function(t){return 12>t.getHours()?"A":"P"},TT:function(t){return 12>t.getHours()?"AM":"PM"},u:function(t){return _(t,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(t){var e=t.getDate();return e>10&&20>e?"th":["st","nd","rd"][e%10-1]||"th"},w:function(t,e){return e.weekNumberCalculation(t)},W:function(t){return x(t)}};_e.dateFormatters=Se,_e.applyAll=J,we.month=te,we.basicWeek=ee,we.basicDay=ie,i({weekMode:"fixed"}),we.agendaWeek=re,we.agendaDay=ae,i({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:.5},minTime:0,maxTime:24})})(jQuery);